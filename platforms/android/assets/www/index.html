<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title>eHDSS</title>

    <link href="lib/ionic/css/ionic.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <!-- <script src="lib/ionic/js/ionic.bundle.min.js"></script> -->
    <script src="lib/ionic/js/ionic.bundle.min_v1.3.3.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="js/ng-cordova.min.js"></script> <!-- ditambahkan ketika akan membuat media player -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/localforage.min.js"></script>
    <script src="js/app.js"></script>
    <!-- Kini controller dipisah-pisah untuk memudahkan  -->
    <!-- Controller yg dikomentar sementara tidak dipakai di siklus yg dikembangkan -->
    <script src="js/controller.home.js"></script>
    <script src="js/controller.setting.js"></script>
    <script src="js/controller.user.js"></script>
    <script src="js/controller.art.js"></script>
    <script src="js/controller.others.js"></script>
    <script src="js/controller.pm.js"></script>
    <script src="js/controller.ptm.js"></script>
    <script src="js/controller.rt.js"></script>
    <script src="js/controller.mch.js"></script>
    <script src="js/controller.ichc.js"></script>
    <script src="js/controller.ir.js"></script>
    <script src="js/controller.png.js"></script>
    <script src="js/controller.prk.js"></script>
    <script src="js/controller.bkia.js"></script>
    <script src="js/controller.ichcp.js"></script>

    <script src="js/factory.app.js"></script>
    <script src="js/md5.min.js"></script>
  </head>

  <body ng-app="ehdss">
    <ion-nav-view>
    </ion-nav-view>
  </body>
</html>

<script type="text/javascript">
  // Script perhitungan ukuran localforage
  // var getTableSize = function(db, dbName){
  //   return new Promise((resolve,reject) => {
  //     if (db == null) {
  //       return reject();
  //     }
  //     var size = 0;
  //     db = event.target.result;
  //     var transaction = db.transaction([dbName])
  //       .objectStore(dbName)
  //       .openCursor();

  //     transaction.onsuccess = function(event){
  //         var cursor = event.target.result;
  //         if(cursor){
  //             var storedObject = cursor.value;
  //             var json = JSON.stringify(storedObject);
  //             size += json.length;
  //             cursor.continue();
  //         }
  //         else{
  //           resolve(size);
  //         }
  //     }.bind(this);
  //     transaction.onerror = function(err){
  //         reject("error in " + dbName + ": " + err);
  //     }
  //   });
  // };

  // var getDatabaseSize = function (dbName) {
  //   var request = indexedDB.open(dbName);
  //   var db;
  //   var dbSize = 0;
  //   request.onerror = function(event) {
  //     alert("Why didn't you allow my web app to use IndexedDB?!");
  //   };
  //   request.onsuccess = function(event) {
  //     db = event.target.result;
  //     var tableNames = [ ...db.objectStoreNames ];
  //     (function(tableNames, db) {
  //       var tableSizeGetters = tableNames
  //         .reduce( (acc, tableName) => {
  //           acc.push( getTableSize(db, tableName) );
  //           return acc;
  //         }, []);

  //       Promise.all(tableSizeGetters)
  //         .then(sizes => {
  //           console.log('--------- ' + db.name + ' -------------');
  //           tableNames.forEach( (tableName,i) => {
  //             console.log(" - " + tableName + "\t: " + humanReadableSize(sizes[i]));
  //           });
  //           var total = sizes.reduce(function(acc, val) {
  //             return acc + val;
  //           }, 0);

  //           console.log("TOTAL: " + humanReadableSize(total))
  //         });
  //       })(tableNames, db);
  //   };
  // };

  // var humanReadableSize = function (bytes) {
  //   var thresh = 1024;
  //   if(Math.abs(bytes) < thresh) {
  //     return bytes + ' B';
  //   }
  //   var units = ['KB','MB','GB','TB','PB','EB','ZB','YB'];
  //   var u = -1;
  //   do {
  //     bytes /= thresh;
  //     ++u;
  //   } while(Math.abs(bytes) >= thresh && u < units.length - 1);
  //   return bytes.toFixed(1)+' '+units[u];
  // }

  // var printIndexDBSizes = function() {
  //     var databaseNames = ['ehdss-data-2020'];
  //     var dbName;
  //     for(var i=0; i < databaseNames.length; i++) {
  //       dbName = databaseNames[i];
  //       getDatabaseSize(dbName);
  //     };
  // }
  // //usage
  // printIndexDBSizes();

</script>
